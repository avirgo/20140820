grep -ve ':!!:' /etc/shadow|grep -v ':\*:\|root'|sort|while read line;do un=${line/:*/};x=$(grep "^$un" /etc/passwd);cmt=$(echo $x|cut -f5 -d:);pwd=$(echo $line|cut -f2 -d:);l=($(echo $x|cut -f1-4 -d: --output-delimiter=" "));gn=$(grep ":${l[3]}:" /etc/group|cut -f1 -d:);echo "${un}_$HOSTNAME: groupadd -f -g ${l[3]} $gn";echo "${un}_$HOSTNAME: useradd -m -p '$pwd' --comment \"$cmt\" --uid ${l[2]} ${l[3]} $un";done
